/*
 * minion.JS v2.0.0-alpha
 * http://minion.org
 *
 * (c) 2012, Taka Kojima (taka@gigafied.com)
 * Licensed under the MIT License
 *
 * Date: Mon Feb 20 02:51:24 2012 -0800
 */
 var minion=function(a){"use strict",Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){if(!!this.length&&this instanceof Array&&arguments.length>=1){b=b||0;if(b<this.length){while(b<this.length){if(this[b]===a)return b;b++}return-1}return-1}return-1}),Function.prototype.bind||(Function.prototype.bind=function(a){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a||window,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e});var b=[],c=["minion"],d="",e="",f,g=[],h=[],i,j=[],k=[],l,m=500,n=typeof window=="undefined",o=a,p={},q=[],r={},s=function(a){return a instanceof Array},t=function(a){return typeof a=="object"},u=function(a){return typeof a=="function"},v=function(a){return s(a)?a:[a]},w=function(){var a,b,c,d,e;c={},d={},e=[];for(a=g.length-1;a>=0;a--){c=g[a];for(var b=c.c.length-1;b>=0;b--){console.log(c.c[b]);if(!D.isDefined(c.c[b])){setTimeout(w,0);return}}c.cb&&c.cb.apply(o,D.get(c.c)),g.splice(a,1)}},x=function(){var a=h,b,c,d,e;for(b=a.length-1;b>=0;b--){d=a[b].split(minion.separator),e=d.splice(d.length-1,1)[0],d=D.get(d.join(minion.separator),!1);if(d[e].$$.toExtend){c=D.get(d[e].$$.extendedFrom,!1);if(D.isDefined(c)){d[e].$$.toExtend=!1,delete d[e].$$.toExtend,d[e]=D.extend(d[e].$$.extendedFrom,d[e]),a.splice(b,1),setTimeout(x,0);return}}}if(a.length>0){setTimeout(x,0);return}w()},y=function(){var a=j,b,c;clearTimeout(i);for(b=0;b<a.length;b+=1)c=a[b],c.e+=50,c.e>=D.errorTimeout&&c.s.onerror();a.length>0&&(i=setTimeout(y,m))},z=function(a,b){var c=document,d="body",e,f;if(!c[d])return setTimeout(function(){z(a,b)},0);f=c.createElement("script"),f.async=!0,e={f:a,c:b,e:0,s:f},j.push(e),f.onreadystatechange=f.onload=function(a){e.s.onload=e.s.onreadystatechange=null,e.s.onerror=null,j.splice(j.indexOf(e),1)},f.onerror=function(a){throw e.s.onload=e.s.onreadystatechange=null,e.s.onerror=null,j.splice(j.indexOf(e),1),Error(e.c+" failed to load. Attempted to load from file: "+e.f)},f.src=a,c[d].appendChild(f)},A=function(a){g.push(a);for(var b=0;b<a.f.length;b+=1)n?require(a.f[b]):z(a.f[b],a.c[b]);i=setTimeout(y,m)},B=function(a,b,d){a=a||"",d=d||!1;var e=p,f;if(a&&!t(a)&&!u(a)){var g=a.split(minion.separator);c.indexOf(g[0])>-1&&(e=D,g.splice(0,1));for(f=0;f<g.length;f+=1){if(!e[g[f]]){if(!b)return!1;e[g[f]]={}}e=e[g[f]]}}else{if(a==="")return!1;e=a}if(d)for(var i in d){var j=a+minion.separator+i,k=d[i];k.$$.toExtend&&h.indexOf(j)<0&&h.push(j),e[i]=k}return e},C=function(a){var b=a.name,c=r[b].splice(0),d=c.length;while(a.pointer<d){if(a.status!=1)return;c[a.pointer](a),a.pointer++}c=null,a.status===1&&!a.callback&&a.cancel()},D={};D.separator=".",D.errorTimeout=2e4,D.configure=function(a){a=a||{},d=a.classPath||d,d=d.lastIndexOf("/")===d.length-1?d:d+"/",minion.separator=a.separator||minion.separator,e=a.fileSuffix||e;if(a.paths)for(var b=0;b<a.paths.length;b++){var c=a.paths[b];D.provides(c.file,c.classes)}f=!0},D.define=function(a,b){var c=B(a,!0,b);return x(),c},D.get=function(a){if(!s(a))return B(a,!1);var b=[];for(var c=0;c<a.length;c++)b.push(D.get(a[c]));return b},D.getURL=function(a){if(b[a])return b[a];var c=a.indexOf("*")>-1;a=c?a.replace(".*",""):a;var f=d+a.replace(RegExp("\\"+minion.separator,"g"),"/")+(c?"":".js")+(e?"?"+e:"");return f},D.isDefined=function(a){return a=!t(a)&&!u(a)?B(a,!1):a,a?a.$$.isDefined:!1},D.extend=function(a,b){return b.$$=b.$$||{},D.isDefined(a)?b=D.get(a).extend(b):(b.$$.toExtend=!0,D.require(a)),b.$$.extendedFrom=a,b},D.provides=function(a,c){c=v(c);for(var d=0;d<c.length;d+=1)b[c[d]]=a},D.require=function(a,b){f||D.configure(),a=v(a);var c=[],d=[];for(var e=0;e<a.length;e++){var g=a[e],h=D.getURL(g),i=D.get(g);d.push(g),k.indexOf(h)<0&&!D.get(g)&&(c.push(h),k.push(h))}if(c.length>0){var j={f:c,c:d,cb:b};setTimeout(function(){A(j)},0)}else b&&b.apply(o,D.get(a))},D.proxy=function(a,b){return a?a.bind(b):a};var E=function(a,b,c){this.name=a,this.data=b,this.callback=c};return E.prototype.data={},E.prototype.name="",E.prototype.dispatcher=null,E.prototype.status=0,E.prototype.pointer=0,E.prototype.callback=null,E.prototype.hold=function(){this.status=2},E.prototype.release=function(){this.status=1,D.releaseNotification(this)},E.prototype.cancel=function(){this.data={},this.name="",this.status=0,this.pointer=0,this.dispatcher=null,this.callback=null,D.cancelNotification(this)},E.prototype.dispatch=function(a){this.status=1,this.pointer=0,this.dispatcher=a,D.publishNotification(this)},E.prototype.respond=function(a){this.callback&&(this.callback.apply(this.dispatcher,arguments),this.cancel())},D.subscribe=function(a,b,c){c=isNaN(c)?-1:c,r[b]=r[b]||[],c>-1&&c<r[b].length?r[b].splice(c,0,a):r[b].push(a)},D.unsubscribe=function(a,b){var c=r[b].indexOf(a);c>-1&&r[b].splice(c,1)},D.publish=function(a,b,c,d){a=new E(a,b,d),a.status=1,a.pointer=0,a.dispatcher=c,D.publishNotification(a)},D.publishNotification=function(a){var b=a.name;q.push(a),C(a)},D.releaseNotification=function(a){a.status=1,q.indexOf(a)>-1&&C(a)},D.cancelNotification=function(a){var b=a.name;q.splice(q.indexOf(a),1),a=null},o.define&&o.define.amd?o.define(D):"",n?module.exports=D:"",D}(this);(function(){"use strict";var a=function(a,b){return function(){var c=this.sup||null;this.sup=b;var d=a.apply(this,arguments);return this.sup=c,d}},b=function(a){while(arguments.length>1){var b=Array.prototype.splice.call(arguments,1,1)[0];for(var c in b)a[c]=b[c]}return a},c=/xyz/.test(function(){var a})?/\bthis\.sup\b/:/.*/;minion.define("minion",{BaseClass:function(){var d=function(){},e=function(){};return e.$$={isDefined:!0},e.extend=function(e,f){function i(){var a=this.preInit||this.init||this.prototype.constructor;return a.apply(this,arguments)}var g;d.prototype=this.prototype;var h=b(new d,e);for(var g in e)g!=="static"&&typeof e[g]=="function"&&typeof this.prototype[g]=="function"&&c.test(e[g])&&(h[g]=a(e[g],this.prototype[g]));return i.prototype=h,b(i,this,e.static,f),i.prototype.constructor=i.prototype.static=i,i},e}()})})(),function(){"use strict",minion.define("minion",{Class:minion.extend("minion.BaseClass",{init:function(){},setTimeout:function(a,b){return setTimeout(this.proxy(a),b)},setInterval:function(a,b){return setInterval(this.proxy(a),b)},proxy:function(a){return minion.proxy(a,this)},subscribe:function(a,b,c){this._interestHandlers=this._interestHandlers||[],b&&!this._interestHandlers[a]&&(b=this.proxy(b),minion.subscribe(b,a,c),this._interestHandlers[a]=b)},unsubscribe:function(a){if(this._interestHandlers&&this._interestHandlers[a]){var b=this._interestHandlers[a];this._interestHandlers[a]=null,delete this._interestHandlers[a]}minion.unsubscribe(b,a)},unsubscribeAll:function(){for(var a in this._interestHandlers)this._interestHandlers.hasOwnProperty(a)&&this.unsubscribe(a);this._interestHandlers=[]},publish:function(a,b,c){minion.publish(a,b,this,c)}})})}(),function(){"use strict",minion.define("minion",{Singleton:minion.extend("minion.Class",{init:function(){},preInit:function(){return this.static.$$.instance||(this.init.apply(this,arguments),this.static.$$.instance=this),this.static.$$.instance},"static":{getInstance:function(){if(!this.$$.instance){var a=this;this.$$.instance=new a}return this.$$.instance}}})})}();
