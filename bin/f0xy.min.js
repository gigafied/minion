/*
 * f0xy.JS v1.0
 * http://f0xy.org
 *
 * (c) 2011, Taka Kojima
 * Licensed under the MIT License
 *
 * Date: Tue Nov 22 14:04:13 2011 -0800
 */
 var f0xy=function(a){"use strict",Array.prototype.indexOf=Array.prototype.indexOf||function(a,b){for(var c=this.length,b=b<0?b+c<0?0:b+c:b||0;b<c&&this[b]!==a;b++);return c>b?b:-1},Function.prototype.bind=Function.prototype.bind||function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){var d=b.concat(Array.prototype.slice.call(arguments));return this!==e&&d.push(this),a.apply(c,d)}};var b=[],c=".",d="",e=a,f={},g=!1,h=[],i=[],j=null,k=[],l=[],m=Array.isArray||function(a){return toString.call(a)=="[object Array]"},n=function(a){return Object(a)===a},o=function(a){return typeof a=="string"},p=function(a){return toString.call(a)=="[object Function]"},q=function(a){return o(a)?[a]:a},r=function(a,b){return b=b||[],(a?a:[]).concat(b)},s=setTimeout,t=function(){var a=i;for(var b=a.length-1;b>=0;b--){var d=a[b].split(c),e=d.splice(d.length-1,1);d=y.get(d.join(c),!1);if(d[e].toExtend){var f=y.get(d[e].extendedFrom,!1);if(f.isClass){d[e].toExtend=!1,delete d[e].toExtend,d[e]=y.extend(f,d[e]),a.splice(b,1),t();return}}}u()},u=function(){for(var a=h.length-1;a>=0;a--){var b=h[a],c=!0;for(var d=0;d<b.c.length;d++){var e=y.get(b.c[d],!1);if(!e.isClass)c=!1;else if(e.dependencies)for(var f=0;f<e.dependencies.length;f++)if(!y.isClass(e.dependencies[f])){c=!1;break}if(!c)break}c&&(b.cb&&s(b.cb,10),h.splice(a,1))}},v=function(){var a=k;j&&clearTimeout(j);for(var b=0;b<a.length;b++){var c=a[b];c.e+=50,y.isClass(c.c)?c.s.onload():c.e>=y.errorTimeout&&c.s.onerror()}a.length>0&&(j=s(v,50))},w=function(a){function d(a,e){if(l.indexOf(a)<0){if(!b[c])return s(d,0,a,e);var f=b.createElement("script");f.async=!0,f.src=a;var g={f:a,c:e,e:0,s:f};l.push(a),k.push(g),f.onreadystatechange=f.onload=function(a){y.isClass(e)&&(g.s.onload=f.onreadystatechange=null,k.splice(k.indexOf(g),1))},f.onerror=function(a){throw k.splice(k.indexOf(g),1),new Error(g.c+" failed to load. Attempted to load from file: "+g.f)},b[c].appendChild(f)}}var b=document,c="body";h.push(a);for(var e=0;e<a.f.length;e++)d(a.f[e],a.c[e]);j=s(v,50)},x=function(a,b,d){d=d||!1;var e=y.ns;if(a!=""&&!n(a)&&!p(a)){var f=a.split(c);f[0]==="f0xy"&&(e=y,f.splice(0,1));for(var g=0;g<f.length;g++){if(!e[f[g]])if(b)e[f[g]]={};else return!1;e=e[f[g]]}}else a!=""&&(e=a);if(d){d.require=r(d.require);var h=d.require;for(var j in d)if(j!=="require"){var k=a+c+j,l=d[j];l.extendedFrom&&h.push(l.extendedFrom),l.toExtend&&i.indexOf(k)<0&&i.push(k),l.nsID=a,l.ns=e,l.className=j,h.length>0&&(l.dependencies=r(l.dependencies,h),y.require(h));if(y.isClass(l)&&l.prototype){var m=l.prototype;m.nsID=a,m.ns=e,m.className=j,h.length>0&&(m.dependencies=r(m.dependencies,h))}e[j]=l}}return e},y={};return y.ns={},y.errorTimeout=1e4,y.configure=function(a,b,f){d=a||d,c=b||c,d=d.lastIndexOf("/")===d.length-1?d:d+"/";if(!g){if(f!==!1){for(var h in y.ns)e[h]||(e[h]=y.ns[h]);y.ns=e}g=!0}},y.get=function(a){return x(a,!1)},y.define=function(a,b){var c=x(a,!0,b);return t(),c},y.getURL=function(a){return b[a]?b[a]:d+a.replace(new RegExp("\\"+c,"g"),"/")+".js"},y.isClass=function(a){return a=!n(a)&&!p(a)?x(a,!1):a,a?a.isClass:!1},y.extend=function(a,b){return y.isClass(a)?b=y.get(a).extend(b):b.toExtend=!0,b.extendedFrom=a,b},y.use=function(a){f0xy.unuse(a),a=q(a);for(var b=0;b<a.length;b++){var d=a[b],e=d.split(c),g=e.pop(),h=y.get(e.join(c),!1);if(g==="*")for(var i in h)f[i]=y.ns[i]?y.ns[i]:null,y.ns[i]=h[i];else h[g]&&(f[g]=y.ns[g]?y.ns[g]:null,y.ns[g]=h[g])}},y.unuse=function(){for(var a in f)y.ns[a]=f[a],y.ns[a]===null&&delete y.ns[a]},y.provides=function(a,c,e,f){c=q(c),a=(new RegExp("(http://|/)[^ :]+")).test(a)?a:d+a;for(var g=0;g<c.length;g++)b[c[g]]=a;e&&y.require(c,f)},y.require=function(a,b){g||f0xy.configure(),a=q(a);var c=[],d=[];for(var e=0;e<a.length;e++){var f=a[e],h=y.getURL(f);l.indexOf(h)<0&&!y.get(f)&&(c.push(h),d.push(f))}if(c.length>0){var i={f:c,c:d,cb:b};w(i)}else b&&s(b,0)},y}(this);f0xy.define("f0xy",{$$__BaseClass__$$:function(a){var b=function(){};return b.isClass=!0,b.extend=function c(b){a=!1;var d=new this;a=!0;var e=this;d.dependencies&&(b.dependencies=b.dependencies||[],b.dependencies=b.dependencies.concat(d.dependencies));for(name in b)d[name]=typeof b[name]=="function"&&typeof e.prototype[name]=="function"?function(a,b){return function(){this._super=e.prototype[a];var c=b.apply(this,arguments);return this._super=null,delete this._super,f0xy.unuse(),c}}(name,b[name]):b[name];var f=function(){a&&this.init&&this.init.apply(this,arguments)};return f.prototype=d,f.constructor=f,f.extend=c,f.isClass=!0,b.ns&&(f.ns=b.ns),b.nsID&&(f.nsID=b.nsID),b.className&&(f.className=b.className),b.dependencies&&(f.dependencies=b.dependencies),f},b}()}),f0xy.define("f0xy",{Class:f0xy.extend("f0xy.$$__BaseClass__$$",{isClass:!0,init:function(){},use_dependencies:function(){this.dependencies&&f0xy.use(this.dependencies)},setTimeout:function(a,b){return window.setTimeout(this.proxy(a),b)},setInterval:function(a,b){return window.setInterval(this.proxy(a),b)},proxy:function(a){return a.bind(this)}})});
