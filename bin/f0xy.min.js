/*
 * f0xy.JS v1.0
 * http://f0xy.org
 *
 * (c) 2011, Taka Kojima
 * Licensed under the MIT License
 *
 * Date: Mon Nov 21 16:46:22 2011 -0800
 */
 var f0xy=function(){"use strict",Array.prototype.indexOf=Array.prototype.indexOf||function(a){if(this===void 0||this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(c===0)return-1;var d=0;arguments.length>0&&(d=Number(arguments[1]),d!==d?d=0:d!==0&&d!==Infinity&&d!==-Infinity&&(d=(d>0||-1)*Math.floor(Math.abs(d))));if(d<c){var e=d<0?Math.max(c-Math.abs(d),0):d;for(;e<c;e++)if(e in b&&b[e]===a)return e;return-1}return-1},Function.prototype.bind=Function.prototype.bind||function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){var d=b.concat(Array.prototype.slice.call(arguments));return this!==window&&d.push(this),a.apply(c,d)}};var a=[],b=[],c=".",d="",e=[],f=[],g={},h=!1,i="string",j="function",k="object",l="undefined",m=function(a,b,c,d){return d=typeof a===b,d=!d&&c?typeof a===c:d,d},n=function(){var a=!1;for(var b=f.length-1;b>=0;b--){var d=f[b].split(c),e=d.splice(d.length-1,1),g=d.join(c),h=q.get(g,!1),i=h[e];if(i.toExtend){var j=q.get(i.extendedFrom,!1);if(j.isClass){var k=i.dependencies,l=i.extendedFrom;i.toExtend=!1,delete i.toExtend,h[e]=j.extend(i),a=!0,f.splice(b,1)}}}a&&f.length>0&&n()},o=function(){for(var a=e.length-1;a>=0;a--){var c=e[a],d=!0;for(var f=0;f<e[a].classes.length;f++){var g=q.get(e[a].classes[f],!1);if(!g.isClass)d=!1;else if(g.dependencies)for(var h=0;h<g.dependencies.length;h++)if(b.indexOf(g.dependencies[h])===-1){d=!1;break}if(!d)break}d&&(e.splice(a,1),c.complete&&c.complete.call())}},p=function(a,b){function f(){if(!d[e])return setTimeout(f,50);for(var g=0;g<a.length;g++){var h=d.createElement("script");h.onload=h.onreadystatechange=function(d,e){c++,c>=a.length&&b.call()},h.async="async",h.src=a[g],d[e].appendChild(h)}}var c=0,d=document,e="body";!m(a,k)&&!a.sort&&(a=Array(a)),f()},q={};return q.ns={},q.configure=function(a,b,e){d=a||d,c=b||c,d=d.lastIndexOf("/")===d.length-1?d:d+"/";if(e!==!1){for(var f in q.ns)window[f]||(window[f]=q.ns[f]);q.ns=window}h=!0},q.namespace=function(a,b,d){d=d||!1;var e=q.ns;if(a!=""&&!m(a,k,j)){var g=a.split(c);g[0]==="f0xy"&&(e=this,g.splice(0,1));for(var h=0;h<g.length;h++){if(!e[g[h]])if(b)e[g[h]]={};else return!1;e=e[g[h]]}}else m(a,k)&&(e=a);if(d!==!1){d.require||(d.require=[]);for(var i in d){var l=a+c+i;d[i].extendedFrom&&d.require.push(d[i].extendedFrom),d[i].toExtend&&f.indexOf(l)===-1&&f.push(l);if(i!=="require"){var n=d[i];n.nsID=a,n.ns=e,n.className=i,"require"in d&&d.require.length>0&&(n.dependencies=(n.dependencies?n.dependencies:[]).concat(d.require),q.require(d.require)),q.isClass(n)&&n.prototype&&(n.prototype.nsID=a,n.prototype.ns=e,n.prototype.className=i,"require"in d&&d.require.length>0&&(n.prototype.dependencies=(n.prototype.dependencies?n.prototype.dependencies:[]).concat(d.require))),e[i]=n}}}return e},q.get=function(a){return q.namespace(a,!1)},q.define=function(a,b){return q.namespace(a,!0,b)},q.getURL=function(b){if(a[b])return a[b];var e=new RegExp("\\"+c,"g");return d+b.replace(e,"/")+".js"},q.isClass=function(a){return a=m(a,k,j)?a:q.namespace(a,!1),a?a.isClass:!1},q.extend=function(a,b){return q.isClass(a)?b=q.get(a).extend(b):b.toExtend=!0,b.extendedFrom=a,b},q.use=function(a){f0xy.unuse(a),!m(a,k)&&!a.sort&&(a=Array(a));for(var b=0;b<a.length;b++){var d=a[b],e=d.split(c),f=e.pop(),h=q.get(e.join(c),!1);if(f==="*")for(var i in h)g[i]=q.ns[i]?q.ns[i]:null,q.ns[i]=h[i];else h[f]&&(g[f]=q.ns[f]?q.ns[f]:null,q.ns[f]=h[f])}},q.unuse=function(){for(var a in g)q.ns[a]=g[a],q.ns[a]===null&&delete q.ns[a]},q.provides=function(b,c,e,f){!m(c,k)&&!c.sort&&(c=Array(c)),b=(new RegExp("(http://|/)[^ :]+")).test(b)?b:d+b;for(var g=0;g<c.length;g++)a[c[g]]=b;e&&q.require(c,f)},q.require=function(a,c){h||f0xy.configure(),m(a,i)&&(a=[a]);var d=[];for(var f=0;f<a.length;f++){var g=a[f];b.indexOf(g)===-1&&!q.get(g)&&d.push(q.getURL(g))}if(d.length>0){var j={classes:a,classFiles:d,complete:c};e.push(j),p(d,function(){b=b.concat(a),n(),o()})}else b=b.concat(a),c&&c.call()},q}();f0xy.define("f0xy",{$$__BaseClass__$$:function(a){var b=function(){};return b.isClass=!0,b.extend=function c(b){a=!1;var d=new this;a=!0;var e=this;d.dependencies&&(b.dependencies=b.dependencies||[],b.dependencies=b.dependencies.concat(d.dependencies));for(name in b)d[name]=typeof b[name]=="function"&&typeof e.prototype[name]=="function"?function(a,b){return function(){f0xy.use(this.dependencies),this._super=e.prototype[a];var c=b.apply(this,arguments);this._super=null,delete this._super,f0xy.unuse()}}(name,b[name]):b[name];var f=function(){a&&this.init&&this.init.apply(this,arguments)};return f.prototype=d,f.constructor=f,f.extend=c,f.isClass=!0,b.ns&&(f.ns=b.ns),b.nsID&&(f.nsID=b.nsID),b.className&&(f.className=b.className),b.dependencies&&(f.dependencies=b.dependencies),f},b}()}),f0xy.define("f0xy",{Class:f0xy.extend("f0xy.$$__BaseClass__$$",{isClass:!0,init:function(){},use_dependencies:function(){this.dependencies&&f0xy.use(this.dependencies)},setTimeout:function(a,b){return window.setTimeout(this.proxy(a),b)},setInterval:function(a,b){return window.setInterval(this.proxy(a),b)},proxy:function(a){return a.bind(this)}})});
